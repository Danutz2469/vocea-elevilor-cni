<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
    <title>Vocea Elevilor | CNI Piatra Neam»õ</title>
    <link rel="icon" type="image/png" href="logo-scoala.png">
    <style>
        /* --- CSS STYLES --- */
        :root{
            --primary:#1e3a8a; --accent:#3b82f6; --bg:#f0f4f8; --card:#fff; --muted:#6b7280;
            --probleme-color: #ef4444; --bullying-color: #7c3aed; --sugestii-color: #10b981; 
            --acad-color: #2563eb; --resurse-color: #f59e0b;
        }
        *{box-sizing:border-box}
        
        body{
            font-family:'Inter',Arial,Helvetica,sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            background-attachment: fixed;
            margin:0;color:#111;
            min-height: 100vh;
            padding-bottom: 50px;
        }

        /* HEADER & NAVIGARE */
        header {
            background: var(--primary);
            position: sticky; top: 0; z-index: 1000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            padding: 0 15px;
            background-image: url('hero-bg.jpg'); 
            background-size: cover; background-position: center;
        }
        header::before {
            content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(30, 58, 138, 0.9); z-index: -1;
        }
        
        .navbar {
            max-width: 1200px; margin: 0 auto;
            display: flex; justify-content: space-between; align-items: center;
            height: 85px; 
            position: relative; z-index: 2;
        }

        .logo-area {
            display: flex; align-items: center; gap: 10px; color: white; font-weight: 700; font-size: 1.2rem;
        }
        .logo-area img { height: 40px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.3); }

        .nav-menu {
            display: flex; gap: 5px;
        }

        .nav-btn {
            background: transparent; border: none; color: rgba(255,255,255,0.8);
            padding: 10px 15px; font-size: 14px; font-weight: 600; cursor: pointer;
            border-radius: 6px; transition: all 0.3s;
        }

        .nav-btn:hover { background: rgba(255,255,255,0.1); color: white; }
        
        .nav-btn.active {
            background: var(--accent); color: white; box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .admin-btn {
            background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.3);
            margin-left: 10px;
        }
        .admin-btn:hover { background: #c81919; border-color: #c81919; }

        /* CONTAINERE PRINCIPALE */
        .container { max-width: 1000px; margin: 30px auto; padding: 0 20px; }
        
        .view-section { display: none; animation: fadeIn 0.5s ease; }
        .view-section.active-view { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* CARDS & ANIMA»öII */
        .card {
            background: white; padding: 25px; border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05); margin-bottom: 25px;
            border-left: 5px solid var(--primary);
            transition: all 0.3s ease-in-out; /* Pentru a aplica imediat culorile de border */
            opacity: 0; transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        
        /* V4.9 FIX: Fix Problem Card Glitch - AsigurƒÉ culoarea ro»ôie */
        #problemCard {
            border-left-color: var(--probleme-color); 
        }
        #view-sesizari .card:nth-child(2) { /* Bullying card */
            border-left-color: var(--bullying-color);
        }
        #view-sesizari .card:nth-child(3) { /* Academic card */
            border-left-color: var(--acad-color);
        }

        .card.revealed {
            opacity: 1; transform: translateY(0);
        }
        
        .card:hover{transform:translateY(-5px);box-shadow:0 6px 20px rgba(0,0,0,0.15);}

        /* ANIMATIE SUCCES RAPORTARE & VOT (Pulse) */
        .card.submission-success {
            animation: success-pulse 0.5s ease-out;
        }
        .card.submission-success#problemCard {
            animation: success-pulse-problem 0.5s ease-out;
        }
        @keyframes success-pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); } 
            50% { transform: scale(1.01); box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }
         @keyframes success-pulse-problem {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); } 
            50% { transform: scale(1.01); box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        h2 { margin-top: 0; color: var(--primary); border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        h3 { margin-top: 25px; color: var(--muted); font-size: 1.1rem; }

        /* FORMULARE */
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 0.9rem; color: #444; }
        
        input[type="file"] {
            padding: 8px; /* Ajustare padding pentru input file */
            border: 1px dashed #ddd; /* Stil vizual diferit */
            background: #fcfcfc;
        }

        input, select, textarea {
            width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px;
            font-size: 1rem; transition: border-color 0.3s; font-family: inherit;
            resize: vertical; /* FIX V4.9: Permite doar redimensionarea verticalƒÉ */
        }
        input:focus, select:focus, textarea:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
        
        button.submit-btn {
            background: var(--primary); color: white; border: none; padding: 12px 25px;
            border-radius: 8px; font-weight: 700; cursor: pointer; width: 100%;
            font-size: 1rem; transition: background 0.2s;
        }
        button.submit-btn:hover { filter: brightness(1.1); }

        /* ADMIN DASHBOARD */
        #admin-dashboard {
            display: none; 
            border: 4px solid var(--primary);
            background: #eef2ff;
            opacity: 1; transform: none; 
        }
        #admin-dashboard.visible { display: block; }
        
        .admin-header { 
            background: var(--primary); color: white; padding: 15px; border-radius: 8px 8px 0 0; margin: -25px -25px 20px -25px; 
            display: flex; justify-content: space-between; align-items: center; 
        }
        .admin-header h3 { margin: 0; color: white; }

        /* ITEME LISTE */
        .data-item {
            background: white; border: 1px solid #ddd; padding: 15px; border-radius: 8px;
            margin-bottom: 15px; position: relative;
        }
        .data-item.urgent-item { border-left: 5px solid var(--probleme-color); background: #fff5f5; }
        
        .item-meta { font-size: 0.85rem; color: var(--muted); margin-bottom: 5px; display: flex; justify-content: space-between; }
        .item-content { font-size: 1rem; color: #333; white-space: pre-wrap; }

        /* Stil pentru pozele adƒÉugate */
        .item-images { margin-top: 10px; padding-top: 10px; border-top: 1px dashed #eee; display: flex; flex-wrap: wrap; gap: 10px; }
        .item-images img { max-width: 100px; height: auto; border-radius: 4px; border: 1px solid #ccc; cursor: pointer; }
        
        .admin-controls {
            margin-top: 10px; padding-top: 10px; border-top: 1px dashed #ccc;
            display: flex; gap: 10px; justify-content: flex-end;
            flex-wrap: wrap; 
        }
        
        .btn-small { padding: 5px 10px; font-size: 0.8rem; border-radius: 4px; border: none; cursor: pointer; color: white; }
        .btn-del { background: var(--probleme-color); }
        .btn-mark-urgent { background: #f59e0b; }
        .btn-resolve { background: #10b981; }
        .btn-status-nou { background: #9ca3af; }

        /* Comentarii Admin */
        .comments-section { margin-top: 15px; padding-top: 10px; border-top: 1px solid #eee; }
        .comment-item { 
            background: #f8fafc; border-left: 3px solid var(--accent); 
            padding: 8px; margin-bottom: 8px; border-radius: 4px; font-size: 0.9rem;
        }
        .comment-meta { font-weight: 600; color: var(--primary); margin-bottom: 3px; }
        .comment-form textarea { resize: vertical; min-height: 40px; }
        .comment-form button { margin-top: 5px; width: auto; padding: 8px 15px; font-size: 0.9rem; }

        /* Progress Bar */
        .progress-bar-container { margin-bottom: 20px; }
        .progress-bar-bg { background: #e2e8f0; border-radius: 5px; height: 20px; overflow: hidden; }
        .progress-bar-fill { background: var(--probleme-color); height: 100%; width: 0; transition: width 1s ease-out; display: flex; align-items: center; justify-content: flex-end; padding-right: 10px; font-weight: 700; color: white; font-size: 0.85rem; }
        .progress-bar-fill.resolved { background: #10b981; }
        
        /* SONDAJ */
        .poll-options { display: flex; flex-direction: column; gap: 10px; margin-top: 15px; }
        .poll-option-label {
            display: flex; align-items: center; justify-content: space-between;
            background: #f8fafc; border: 1px solid #e2e8f0; padding: 12px 15px;
            border-radius: 8px; cursor: pointer; transition: background 0.2s;
        }
        .poll-option-label:hover { background: #eef2ff; }
        .poll-option-label input { width: auto; margin-right: 10px; }
        
        /* Rezultate Sondaj (Bare) */
        .poll-result-item { margin-bottom: 12px; }
        .poll-result-text { display: flex; justify-content: space-between; font-size: 0.9rem; margin-bottom: 4px; }
        .poll-bar-bg { background: #e2e8f0; border-radius: 5px; height: 10px; overflow: hidden; }
        .poll-bar-fill { background: var(--sugestii-color); height: 100%; width: 0; transition: width 0.8s ease-out; } 

        /* Footer & Stelu»õƒÉ */
        footer { text-align: center; color: var(--muted); font-size: 0.9rem; margin-top: 50px; position: relative; padding-top: 20px; border-top: 1px solid #eee; }
        
        .star-badge-footer {
            position: absolute;
            top: -20px; 
            right: 20px;
            width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
            font-size: 24px; color: #facc15; 
            background: var(--card); border-radius: 50%;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border: 2px solid #fff;
            cursor: pointer; /* AdƒÉugat cursor pointer */
            transition: transform 0.1s;
            overflow: hidden; /* Pentru a ascunde particulele ini»õial */
        }
        .star-badge-footer:active { transform: scale(0.95); }

        /* CONTAINER PARTICULE ANIMATIE STELUTA */
        #star-animation-container {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none; /* AsigurƒÉ cƒÉ nu blocheazƒÉ click-urile */
            z-index: 5000;
        }

        /* Stilul individual al particulei */
        .star-particle {
            position: absolute;
            width: 8px; height: 8px;
            background-color: #facc15; /* Culoare galbenƒÉ */
            border-radius: 50%;
            opacity: 0;
            transform: scale(0);
            transition: all 0.5s ease-out;
        }

        /* Toasts */
        @keyframes toastJiggle {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            20%, 60% { transform: translateX(-50%) translateY(-3px); }
            40%, 80% { transform: translateX(-50%) translateY(0); }
        }

        #toast{
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px); 
            background: #334155; color: #fff; padding: 12px 24px; border-radius: 50px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); z-index: 2000; opacity: 0;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            font-weight: 600; font-size: 14px; display: flex; align-items: center; gap: 8px;
        }
        #toast.show{ 
            opacity: 1; 
            transform: translateX(-50%) translateY(0); 
            animation: toastJiggle 0.5s ease-out 0.4s 1; 
        }

        /* Mobile Nav */
        @media (max-width: 768px) {
            .nav-menu { display: none; flex-direction: column; position: absolute; top: 85px; left: 0; width: 100%; background: var(--primary); padding: 10px; }
            .nav-menu.mobile-open { display: flex; }
            .nav-btn { text-align: left; padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); }
            .burger { display: block; color: white; font-size: 24px; cursor: pointer; }
        }
        @media (min-width: 769px) { .burger { display: none; } }
        
        /* Admin Lists Layout */
        .admin-lists-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        @media (max-width: 768px) {
            .admin-lists-container {
                grid-template-columns: 1fr;
            }
        }
        .admin-lists-container h4 {
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1rem;
        }
        
    </style>
</head>
<body>
    <div id="star-animation-container"></div> <header>
        <div class="navbar">
            <div class="logo-area">
                <img src="logo-scoala.png" alt="Logo">
                Vocea Elevilor
            </div>
            <div class="burger" onclick="toggleMenu()">‚ò∞</div>
            <div class="nav-menu" id="mainMenu">
                <button class="nav-btn active" onclick="switchView('acasa', this)">AcasƒÉ</button>
                <button class="nav-btn" onclick="switchView('sesizari', this)">SesizƒÉri</button>
                <button class="nav-btn" onclick="switchView('anunturi', this)">Anun»õuri</button>
                <button class="nav-btn" onclick="switchView('sondaj', this)">Sondaj</button>
                <button class="nav-btn" onclick="switchView('resurse', this)">Resurse</button>
                <button class="nav-btn admin-btn" id="btnAdminAuth" onclick="toggleAdminAuth()">Admin</button>
            </div>
        </div>
    </header>

    <div class="container">

        <div id="view-acasa" class="view-section active-view">
            <div class="card revealed">
                <h2 style="border-bottom:none; margin-bottom:10px;">üëã Bine a»õi venit!</h2>
                <p style="font-size: 1.1rem; line-height: 1.6;">
                    Aceasta este platforma centralizatƒÉ a Consiliului Elevilor <strong>CNI Piatra Neam»õ</strong>. 
                    Aici po»õi afla ultimele noutƒÉ»õi, po»õi vota √Æn sondaje »ôi po»õi trimite sesizƒÉri anonime pentru a √ÆmbunƒÉtƒÉ»õi via»õa »ôcolarƒÉ.
                </p>
                <p style="color:var(--muted); margin-top:5px;">Folosi»õi meniul de sus pentru a naviga.</p>
            </div>

            <div class="card">
                <h2 style="color: var(--acad-color);">üìÖ Calendar Evenimente »òcolare</h2>
                <div id="calendarDisplay">
                    </div>
            </div>
        </div>

        <div id="view-sondaj" class="view-section">
            <div class="card" id="pollCard">
                <h2 style="color: var(--sugestii-color);">üìä Sondaj Rapid: PƒÉrerea Ta ConteazƒÉ</h2>
                <h3 id="pollQuestionDisplay" style="color: #333; margin-bottom: 20px; font-weight:700;">√éntrebare sondaj...</h3>
                
                <div id="pollOptionsDisplay" class="poll-options">
                    </div>

                <div id="pollResultsDisplay" class="poll-results" style="display: none; margin-top: 20px;">
                    </div>
                
                <button id="btnVote" class="submit-btn" style="margin-top:20px; background:var(--sugestii-color);" onclick="submitVote()">VoteazƒÉ</button>
            </div>
        </div>

        <div id="view-resurse" class="view-section">
            <div class="card">
                <h2 style="color: var(--resurse-color);">üîó Resurse »ôi Linkuri Utile</h2>
                <ul style="line-height: 1.8; font-size: 1.05rem;">
                    <li><strong>Program secretariat:</strong> 08:00 - 16:00.</li>
                    <li><a href="regulament.html" target="_blank" style="color: var(--primary); text-decoration:none;">üìÑ Regulamentul Intern »ôi RecomandƒÉri</a></li>
                    <li><strong>Link util:</strong> <a href="https://edu.ro" target="_blank" style="color: var(--primary); text-decoration:none;">üåê Site-ul Ministerului Educa»õiei</a></li>
                </ul>
            </div>

            <div class="card">
                <h2 style="color: var(--sugestii-color);">üí° Sugestii pentru √ÆmbunƒÉtƒÉ»õirea »ôcolii</h2>
                <p>Ai o idee bunƒÉ? Spune-ne!</p>
                <form onsubmit="submitSuggestion(event)">
                    <div class="form-group">
                        <label>Nume (Op»õional)</label>
                        <input type="text" id="sugestieNume" placeholder="Anonim">
                    </div>
                    <div class="form-group">
                        <label>Email (Op»õional - pentru rƒÉspuns)</label>
                        <input type="email" id="sugestieEmail" placeholder="email@exemplu.ro">
                    </div>
                    <div class="form-group">
                        <label>Ideea ta</label>
                        <textarea id="sugestieText" rows="4" placeholder="Descrie ideea..." required></textarea>
                    </div>
                    <button type="submit" class="submit-btn" style="background: var(--sugestii-color);">Trimite Sugestia</button>
                </form>
            </div>
        </div>

        <div id="view-anunturi" class="view-section">
            <div class="card">
                <h2 style="color: var(--resurse-color);">üì¢ Anun»õuri Oficiale</h2>
                <div id="announcementsDisplay">
                    <p style="color: #666;">Nu sunt anun»õuri momentan.</p>
                </div>
            </div>
        </div>

        <div id="view-sesizari" class="view-section">
            
            <div class="card" id="problemCard">
                <h2 style="color: var(--probleme-color);">‚ö†Ô∏è RaporteazƒÉ o problemƒÉ √Æn »ôcoalƒÉ</h2>
                <form onsubmit="submitProblem(event)">
                    <div class="form-group">
                        <label>Loca»õie</label>
                        <input type="text" id="probLocatie" placeholder="Ex: Sala 204, etaj 1" style="font-size: 1.1rem; padding: 15px;" required>
                    </div>
                    <div class="form-group">
                        <label>Tip ProblemƒÉ</label>
                        <select id="probTip">
                            <option>Mobilier rupt</option>
                            <option>CurƒÉ»õenie</option>
                            <option>Iluminat/Electrice</option>
                            <option>Altele</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Descriere</label>
                        <textarea id="probDesc" rows="4" required></textarea>
                    </div>
                    <div class="form-group">
                        <label>AdaugƒÉ Poze (Op»õional)</label>
                        <input type="file" id="probPoze" multiple accept="image/*">
                    </div>
                    <button type="submit" class="submit-btn" style="background: var(--probleme-color);">Trimite Raportare</button>
                </form>
            </div>

            <div class="card">
                <h2 style="color: var(--bullying-color);">üõ°Ô∏è Raportare Bullying (Anonim)</h2>
                <form onsubmit="submitBullying(event)">
                    <div class="form-group">
                        <label>Ce s-a √Ænt√¢mplat?</label>
                        <textarea id="bullDesc" rows="4" placeholder="Descrie situa»õia..." required></textarea>
                    </div>
                    <div class="form-group">
                        <label>Detalii (Loc, orƒÉ - op»õional)</label>
                        <input type="text" id="bullDetalii">
                    </div>
                    <button type="submit" class="submit-btn" style="background: var(--bullying-color);">Trimite Anonim</button>
                </form>
            </div>

            <div class="card">
                <h2 style="color: var(--acad-color);">üéì Probleme Academice / Sprijin</h2>
                <form onsubmit="submitAcademic(event)">
                    <div class="form-group">
                        <label>Tip problemƒÉ</label>
                        <select id="acadTipSelect" required>
                            <option value="" disabled selected>SelecteazƒÉ un tip de problemƒÉ</option>
                            <option value="Materiale didactice">LipsƒÉ materiale didactice</option>
                            <option value="Evaluare subiectivƒÉ">Probleme evaluare subiectivƒÉ</option>
                            <option value="Relatie Profesor">Rela»õie dificilƒÉ cu un profesor</option>
                            <option value="Suport Consiliere">Nevoie de suport/consiliere educa»õionalƒÉ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Descriere/Detalii</label>
                        <textarea id="acadDesc" rows="4" required></textarea>
                    </div>
                    <button type="submit" class="submit-btn" style="background: var(--acad-color);">Trimite Solicitare</button>
                </form>
            </div>
        </div>

        <div id="admin-dashboard">
            <div class="card" style="border-left:none; box-shadow:none; background:none; padding:0;">
                <div class="admin-header">
                    <h3 style="margin:0; color:white;">üîß PANOU ADMINISTRARE</h3>
                    <div style="display:flex; gap: 10px;">
                        <button class="btn-small" onclick="adminDeleteAllData()" style="background:#8b5cf6; border:1px solid rgba(255,255,255,0.5);">»òterge TOATE Datele</button>
                        <button class="btn-small" onclick="logoutAdmin()" style="background:rgba(0,0,0,0.3); border:1px solid rgba(255,255,255,0.5);">Deconectare</button>
                    </div>
                </div>

                <div style="padding: 20px; background: white; border-radius: 0 0 12px 12px;">
                    <div style="margin-bottom: 30px; border-bottom: 2px solid #ddd; padding-bottom: 20px;">
                        <h4 style="margin-top:0;">AdaugƒÉ Con»õinut Public</h4>
                        <div class="form-group">
                            <select id="adminPostType">
                                <option value="anunt">Anun»õ Oficial</option>
                                <option value="calendar">Eveniment Calendar</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <input type="text" id="adminPostTitle" placeholder="Titlu...">
                        </div>
                        <div class="form-group">
                            <input type="date" id="adminPostDate">
                        </div>
                        <div class="form-group">
                            <textarea id="adminPostContent" placeholder="Con»õinut..."></textarea>
                        </div>
                        <button onclick="adminPostContent()" class="submit-btn">PublicƒÉ</button>
                    </div>

                    <div style="margin-bottom: 30px; border-bottom: 2px solid #ddd; padding-bottom: 20px;">
                        <h4 style="margin-top:0;">GestioneazƒÉ Sondajul Public</h4>
                        <div class="form-group">
                            <label>√éntrebarea Sondajului</label>
                            <input type="text" id="adminPollQuestion" placeholder="Introduce»õi √Æntrebarea...">
                        </div>
                        <div class="form-group">
                            <label>Op»õiuni (C√¢te una pe r√¢nd nou)</label>
                            <textarea id="adminPollOptions" rows="4" placeholder="Ex: Op»õiunea 1\nOp»õiunea 2\nOp»õiunea 3"></textarea>
                        </div>
                        <button onclick="adminUpdatePoll()" class="submit-btn" style="background:var(--sugestii-color);">ActualizeazƒÉ Sondaj</button>
                        <button onclick="adminResetPollVotes()" class="btn-small" style="background:var(--probleme-color); margin-top:10px; width:100%;">ReseteazƒÉ Voturi</button>
                    </div>

                    <div class="progress-bar-container">
                        <h4 style="color:var(--probleme-color)">Stadiu Rezolvare SesizƒÉri Probleme</h4>
                        <div class="progress-bar-bg">
                            <div id="problemeProgressBar" class="progress-bar-fill" style="width:0%">0%</div>
                        </div>
                        <p id="countsSpan" style="font-size: 0.9rem; color: var(--muted); margin-top: 5px;"></p>
                    </div>

                    <div class="admin-lists-container">
                        <div>
                            <h4 style="color:var(--probleme-color)">‚ö†Ô∏è SesizƒÉri Probleme</h4>
                            <div id="adminListProbleme"></div>
                            
                            <h4 style="color:var(--sugestii-color); margin-top: 30px;">üí° Sugestii Primite</h4>
                            <div id="adminListSugestii"></div>
                            
                            <h4 style="color:var(--bullying-color); margin-top: 30px;">üõ°Ô∏è Rapoarte Bullying</h4>
                            <div id="adminListBullying"></div>
                        </div>
                        <div>
                            <h4 style="color:var(--acad-color)">üéì SolicitƒÉri Academice</h4>
                            <div id="adminListAcad"></div>
                            
                            <h4 style="color:var(--resurse-color); margin-top: 30px;">üì¢ Anun»õuri Oficiale</h4>
                            <div id="adminListAnunturi"></div>
                            
                            <h4 style="color:var(--resurse-color); margin-top: 30px;">üìÖ Evenimente Calendar</h4>
                            <div id="adminListCalendar"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div id="toast" class="toast"></div> 

    <footer>
        <div class="star-badge-footer" onclick="burstStarAnimation(event)">‚òÖ</div>
        <p>Vocea Elevilor ‚Äî Proiect Erasmus+ | CNI Piatra Neam»õ</p>
        <p style="margin-top:5px;">Dezvoltat de <strong>SEZONOV DANIEL-ADAM</strong></p>
    </footer>

    <script>
        // --- 1. STATE MANAGEMENT (LOCAL STORAGE) ---
        // V10: Actualizez cheia de stocare pentru a gestiona noul c√¢mp 'poze'
        const KEY = 'vocea_elevilor_local_v10';
        
        const createInitialData = () => ({
            probleme: [],
            sugestii: [],
            bullying: [],
            acad: [],
            
            // --- POPULARE CU DATELE CERUTE (Evenimente »ôi Anun»õuri) ---
            anunturi: [
                {
                    id: 101,
                    title: "Procedura de √énscriere la Examenele Na»õionale 2026",
                    date: "12/09/2025",
                    content: "Se aduce la cuno»ôtin»õa elevilor de clasele a VIII-a »ôi a XII-a, precum »ôi pƒÉrin»õilor acestora, cƒÉ a fost publicatƒÉ metodologia oficialƒÉ privind √Ænscrierea »ôi desfƒÉ»ôurarea EvaluƒÉrii Na»õionale »ôi a examenului de Bacalaureat pentru sesiunea 2026. Documentul complet, ce cuprinde calendarul exact, condi»õiile de eligibilitate »ôi structura subiectelor, este disponibil pe site-ul Ministerului Educa»õiei »ôi √Æn sec»õiunea 'Resurse' a platformei »ôcolii. Termenul limitƒÉ pentru depunerea cererilor de √Ænscriere este 30 ianuarie. Elevii sunt ruga»õi sƒÉ completeze formularele cu cea mai mare aten»õie sub √Ændrumarea dirigin»õilor. Orice nelƒÉmurire poate fi adresatƒÉ secretariatului »ôcolii √Æn timpul programului de lucru. VƒÉ rugƒÉm sƒÉ citi»õi cu aten»õie toate detaliile publicate."
                },
                {
                    id: 102,
                    title: "Regulamentul Intern al »òcolii - ModificƒÉri »ôi ActualizƒÉri",
                    date: "12/05/2025",
                    content: "√éncep√¢nd cu data de 1 decembrie, intrƒÉ √Æn vigoare noul Regulament de Organizare »ôi Func»õionare al UnitƒÉ»õii de √énvƒÉ»õƒÉm√¢nt, care include modificƒÉri semnificative √Æn ceea ce prive»ôte utilizarea telefoanelor mobile √Æn timpul orelor »ôi normele de conduitƒÉ √Æn spa»õiile comune. Noile reglementƒÉri vin √Æn urma consultƒÉrilor cu elevii, pƒÉrin»õii »ôi corpul profesoral »ôi au ca scop crearea unui mediu educa»õional mai disciplinat »ôi mai propice √ÆnvƒÉ»õƒÉrii. Textul integral al regulamentului actualizat este afi»ôat la avizierul »ôcolii »ôi poate fi descƒÉrcat de pe pagina principalƒÉ. To»õi membrii comunitƒÉ»õii »ôcolare sunt obliga»õi sƒÉ ia la cuno»ôtin»õƒÉ »ôi sƒÉ respecte aceste prevederi, contribuind astfel la buna desfƒÉ»ôurare a activitƒÉ»õilor."
                },
                {
                    id: 103,
                    title: "Programul de Consiliere PsihopedagogicƒÉ GratuitƒÉ Extins",
                    date: "11/28/2025",
                    content: "»òcoala oferƒÉ sesiuni sƒÉptƒÉm√¢nale extinse de consiliere psihopedagogicƒÉ gratuitƒÉ pentru elevii »ôi pƒÉrin»õii care se confruntƒÉ cu dificultƒÉ»õi de adaptare »ôcolarƒÉ, stres, anxietate sau probleme de comunicare. Programul este sus»õinut de psihologul »ôcolar »ôi are loc √Æn fiecare miercuri »ôi vineri, √Æntre orele 14:00 »ôi 17:00, √Æn cabinetul de specialitate. Pentru a beneficia de o sesiune individualƒÉ, este necesarƒÉ o programare prealabilƒÉ, care se poate face printr-un email trimis la adresa consiliere@scoala.ro sau prin intermediul dirigintelui. Confiden»õialitatea este garantatƒÉ. √éncurajƒÉm to»õi elevii care simt nevoia de sprijin emo»õional sƒÉ apeleze cu √Æncredere la acest serviciu esen»õial pentru starea lor de bine."
                },
                {
                    id: 104,
                    title: "Avertizare Meteo »ôi MƒÉsuri de Siguran»õƒÉ Iarna (Cod Galben)",
                    date: "11/20/2025",
                    content: "√én contextul emiterii unui cod galben de vreme nefavorabilƒÉ (ninsori abundente/ger), rugƒÉm to»õi elevii »ôi pƒÉrin»õii sƒÉ ia mƒÉsuri sporite de precau»õie pe drumul cƒÉtre »ôi de la »ôcoalƒÉ. RecomandƒÉm purtarea de √ÆmbrƒÉcƒÉminte adecvatƒÉ, antiderapante »ôi evitarea zonelor periculoase (ghea»õƒÉ, acoperi»ôuri cu risc de cƒÉdere a »õur»õurilor). De asemenea, √Æn cazul √Æn care condi»õiile meteorologice impun suspendarea cursurilor, anun»õul oficial va fi fƒÉcut public p√¢nƒÉ cel t√¢rziu la ora 6:30 diminea»õa pe site-ul »ôcolii »ôi prin mesaj cƒÉtre dirigin»õi. VƒÉ rugƒÉm sƒÉ urmƒÉri»õi canalele oficiale de comunicare »ôi sƒÉ nu vƒÉ baza»õi pe surse neconfirmate. Siguran»õa elevilor este prioritatea noastrƒÉ absolutƒÉ √Æn aceste condi»õii meteo dificile."
                },
                {
                    id: 105,
                    title: "Recrutare Voluntari pentru Proiectul 'Biblioteca Viitorului'",
                    date: "11/15/2025",
                    content: "LansƒÉm un apel cƒÉtre elevii entuzia»ôti din clasele IX-XI care doresc sƒÉ se implice √Æn modernizarea »ôi digitalizarea fondului de carte al bibliotecii »ôcolare. Proiectul implicƒÉ activitƒÉ»õi de inventariere, etichetare »ôi introducere a datelor √Æn noul sistem informatic, oferind voluntarilor o experien»õƒÉ valoroasƒÉ de lucru √Æn echipƒÉ »ôi organizare. Participarea este recunoscutƒÉ cu diplome de voluntariat, esen»õiale pentru portofoliul personal »ôi dezvoltarea personalƒÉ. Cei interesa»õi sunt invita»õi la o sesiune de informare joi, la ora 13:00, √Æn sala de lecturƒÉ a bibliotecii. VƒÉ rugƒÉm sƒÉ vƒÉ √Ænscrie»õi p√¢nƒÉ miercuri la secretariat. Contribu»õia voastrƒÉ este crucialƒÉ pentru succesul acestui proiect de modernizare."
                }
            ],
            calendar: [
                {
                    id: 201,
                    title: "Ziua Por»õilor Deschise - 15 Noiembrie 2025",
                    date: "2025-11-15",
                    content: "Evenimentul este dedicat elevilor de clasa a VIII-a »ôi pƒÉrin»õilor acestora, oferindu-le ocazia unicƒÉ de a explora facilitƒÉ»õile »ôcolii »ôi de a interac»õiona direct cu profesorii »ôi conducerea. Vom prezenta oferta educa»õionalƒÉ detaliatƒÉ, inclusiv profilurile specializate »ôi activitƒÉ»õile extra»ôcolare disponibile. Este o »ôansƒÉ excelentƒÉ de a √Æn»õelege viziunea noastrƒÉ pedagogicƒÉ »ôi de a pune √ÆntrebƒÉri despre procesul de admitere. Tururile ghidate vor √Æncepe la ora 10:00 »ôi vor include laboratoarele de informaticƒÉ, biblioteca modernƒÉ »ôi terenurile de sport. Participarea se face pe bazƒÉ de √Ænscriere prealabilƒÉ pe site-ul »ôcolii pentru o mai bunƒÉ organizare »ôi estimare a numƒÉrului de vizitatori. VƒÉ a»ôteptƒÉm cu drag √Æn numƒÉr c√¢t mai mare!"
                },
                {
                    id: 202,
                    title: "SƒÉptƒÉm√¢na Verde: Reciclare »ôi Educa»õie EcologicƒÉ",
                    date: "2025-12-02",
                    content: "√én cadrul ini»õiativei na»õionale ‚ÄûSƒÉptƒÉm√¢na Verde‚Äù, »ôcoala noastrƒÉ organizeazƒÉ o serie de activitƒÉ»õi menite sƒÉ creascƒÉ gradul de con»ôtientizare privind protec»õia mediului. Elevii vor participa la ateliere practice de reciclare creativƒÉ, la plantarea de puie»õi √Æn curtea »ôcolii »ôi la sesiuni interactive despre reducerea amprentei de carbon. Fiecare clasƒÉ va concura √Æntr-o competi»õie de colectare separatƒÉ a de»ôeurilor, cu premii ecologice pentru c√¢»ôtigƒÉtori. Scopul principal este de a insufla elevilor un sim»õ al responsabilitƒÉ»õii fa»õƒÉ de naturƒÉ »ôi de a promova practici sustenabile √Æn via»õa de zi cu zi, √ÆnvƒÉ»õ√¢nd totodatƒÉ prin joacƒÉ »ôi experimente practice. VƒÉ rugƒÉm sƒÉ √Æncuraja»õi elevii sƒÉ aducƒÉ materiale reciclabile de acasƒÉ pentru ateliere."
                },
                {
                    id: 203,
                    title: "Concursul de MatematicƒÉ 'Pitagora Junior'",
                    date: "2026-01-20",
                    content: "Cea de-a X-a edi»õie a prestigiosului concurs de matematicƒÉ se va desfƒÉ»ôura online »ôi fizic, adres√¢ndu-se elevilor talenta»õi din clasele V-VIII. Obiectivul este de a stimula g√¢ndirea logicƒÉ »ôi rezolvarea de probleme complexe, depƒÉ»ôind programa »ôcolarƒÉ standard. √énscrierile se fac p√¢nƒÉ la data de 10 ianuarie prin intermediul profesorilor coordonatori de clasƒÉ. Subiectele vor fi elaborate de o comisie de exper»õi »ôi vor testa creativitatea »ôi profunzimea √Æn»õelegerii conceptelor matematice. Cei mai buni elevi vor fi premia»õi √Æn cadrul unei ceremonii speciale »ôi vor avea »ôansa de a participa la etapele superioare ale competi»õiilor na»õionale. RecomandƒÉm pregƒÉtirea intensivƒÉ »ôi consultarea materialelor de antrenament disponibile pe platforma dedicatƒÉ. Mult succes tuturor participan»õilor!"
                },
                {
                    id: 204,
                    title: "»òedin»õƒÉ cu PƒÉrin»õii: Evaluarea SemestrialƒÉ",
                    date: "2026-02-15",
                    content: "Conducerea »ôcolii »ôi cadrele didactice invitƒÉ to»õi pƒÉrin»õii la o »ôedin»õƒÉ generalƒÉ urmatƒÉ de √Ænt√¢lniri individuale cu dirigin»õii. Subiectul principal √Æl constituie analiza performan»õei elevilor dupƒÉ primul semestru, discu»õia despre progresul »ôcolar »ôi identificarea strategiilor de √ÆmbunƒÉtƒÉ»õire a rezultatelor. Vor fi prezentate noile metode de evaluare »ôi instrumentele digitale folosite √Æn procesul didactic. PƒÉrin»õii sunt √Æncuraja»õi sƒÉ participe activ, sƒÉ adreseze √ÆntrebƒÉri »ôi sƒÉ colaboreze cu profesorii pentru a asigura un mediu de √ÆnvƒÉ»õare optim. VƒÉ rugƒÉm sƒÉ confirma»õi prezen»õa la dirigintele clasei p√¢nƒÉ la data de 10 februarie pentru o mai bunƒÉ estimare a numƒÉrului de participan»õi »ôi alocarea spa»õiilor necesare, √Æn vederea unei sesiuni c√¢t mai productive."
                },
                {
                    id: 205,
                    title: "Festivalul de ArtƒÉ »ôi CulturƒÉ »òcolarƒÉ",
                    date: "2026-03-10",
                    content: "Acest eveniment anual celebreazƒÉ talentul artistic al elevilor no»ôtri prin expozi»õii de picturƒÉ, sculpturƒÉ, spectacole de teatru »ôi recitaluri de muzicƒÉ. Festivalul oferƒÉ o platformƒÉ esen»õialƒÉ pentru exprimarea creativitƒÉ»õii »ôi √ÆncurajeazƒÉ dezvoltarea laturii culturale a tinerilor. Elevii de la toate ciclurile de √ÆnvƒÉ»õƒÉm√¢nt sunt invita»õi sƒÉ se √Ænscrie cu crea»õiile lor p√¢nƒÉ la 1 martie. Juriul va acorda premii pentru cele mai originale »ôi bine executate lucrƒÉri din fiecare categorie. Publicul este invitat sƒÉ admire operele »ôi sƒÉ sus»õinƒÉ micii arti»ôti, transform√¢nd evenimentul √Æntr-o adevƒÉratƒÉ sƒÉrbƒÉtoare a comunitƒÉ»õii »ôcolare. Detaliile despre √Ænscriere »ôi programul exact al spectacolelor vor fi publicate sƒÉptƒÉm√¢na viitoare pe site-ul oficial al »ôcolii."
                }
            ],
            sondaj: {
                intrebare: "Ce activitate dori»õi sƒÉptƒÉm√¢na viitoare?",
                optiuni: ["SearƒÉ de Film", "Turneu de »òah", "Club de LecturƒÉ"],
                votes: [0, 0, 0]
            }
        });

        let data = JSON.parse(localStorage.getItem(KEY)) || createInitialData();
        
        // AsigurƒÉ cƒÉ toate intrƒÉrile au status, comments, urgent »ôi poze (pentru probleme)
        ['probleme', 'sugestii', 'bullying', 'acad'].forEach(type => {
            data[type].forEach(item => {
                if(typeof item.status === 'undefined') item.status = 'nou';
                if(typeof item.comments === 'undefined') item.comments = [];
                if(typeof item.urgent === 'undefined') item.urgent = false;
                if(type === 'probleme' && typeof item.poze === 'undefined') item.poze = []; // Noul c√¢mp 'poze'
            });
        });
        
        // --- AsigurƒÉ reini»õializarea c√¢mpurilor (√Æn cazul √Æn care structura veche nu le avea) ---
        ['anunturi', 'calendar'].forEach(type => {
            data[type].forEach(item => {
                if(typeof item.date === 'undefined') item.date = new Date().toLocaleDateString();
            });
        });
        
        let isAdmin = false;
        const ADMIN_PASS = "1234";

        // --- 2. PERSISTENCE & INIT & TOAST ---
        function saveData() {
            localStorage.setItem(KEY, JSON.stringify(data));
            renderPublicContent();
            if(isAdmin) renderAdminPanel();
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.classList.add('show');
            setTimeout(() => { t.classList.remove('show'); }, 3500); 
        }

        // --- 3. NAVIGARE & ANIMATII ---
        function switchView(viewName, btn) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active-view'));
            
            const targetSection = document.getElementById('view-' + viewName);
            targetSection.classList.add('active-view');
            
            const cards = targetSection.querySelectorAll('.card');
            cards.forEach(card => card.classList.remove('revealed'));
            setTimeout(() => {
                cards.forEach((card, index) => {
                    setTimeout(() => card.classList.add('revealed'), index * 100);
                });
            }, 50);

            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');
            
            document.getElementById('mainMenu').classList.remove('mobile-open');
        }

        function toggleMenu() {
            document.getElementById('mainMenu').classList.toggle('mobile-open');
        }

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if(entry.isIntersecting) {
                    entry.target.classList.add('revealed');
                }
            });
        }, { threshold: 0.1 });

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.card').forEach(card => observer.observe(card));
            renderPublicContent();
            // Deschide vizualizarea corectƒÉ bazatƒÉ pe URL Hash sau implicit 'acasa'
            const initialView = (window.location.hash && window.location.hash.substring(1) !== 'admin') ? window.location.hash.substring(1) : 'acasa';
            const initialBtn = document.querySelector(`.nav-btn[onclick*="'${initialView}'"]`);
            switchView(initialView, initialBtn || document.querySelector('.nav-btn.active'));
        });
        
        // NOU: Logica pentru anima»õia stelu»õei
        function burstStarAnimation(event) {
            const star = event.currentTarget;
            const rect = star.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            const container = document.getElementById('star-animation-container');
            
            const particleCount = 10;
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'star-particle';
                
                // Pozi»õia ini»õialƒÉ (centrul stelu»õei)
                particle.style.left = `${centerX}px`;
                particle.style.top = `${centerY}px`;
                
                // ProprietƒÉ»õi aleatorii
                const angle = Math.random() * Math.PI * 2;
                const distance = Math.random() * 50 + 30; // Distan»õa de zbor
                const duration = Math.random() * 0.5 + 0.5; // Durata anima»õiei

                // Pozi»õia finalƒÉ
                const finalX = centerX + distance * Math.cos(angle);
                const finalY = centerY + distance * Math.sin(angle);

                container.appendChild(particle);

                // For»õeazƒÉ reflow pentru a aplica stilul ini»õial
                void particle.offsetWidth; 

                // Anima»õia
                particle.style.transition = `transform ${duration}s ease-out, opacity ${duration}s ease-out`;
                particle.style.transform = `translate(${finalX - centerX}px, ${finalY - centerY}px) scale(0.2)`;
                particle.style.opacity = 0;
                
                // »òterge particula dupƒÉ anima»õie
                setTimeout(() => {
                    container.removeChild(particle);
                }, duration * 1000);
            }
        }


        // --- 4. FORMULARE ELEVI ---
        
        function submitProblem(e) {
            e.preventDefault();
            
            const fileInput = document.getElementById('probPoze');
            const files = fileInput.files;
            const pozeArray = [];
            
            // SimuleazƒÉ √ÆncƒÉrcarea (√Æn lipsa unui backend) prin convertirea fi»ôierelor √Æn URL-uri Data: Base64
            // ATEN»öIE: Aceasta stocheazƒÉ pozele local √Æn browser. Nu este recomandat pentru produc»õie!
            const processFiles = Array.from(files).map(file => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        // LimiteazƒÉ dimensiunea pozei stocate (pentru a nu bloca localStorage)
                        // Aici ar trebui sƒÉ se facƒÉ resize real, dar simplificƒÉm prin stocarea Data URL
                        pozeArray.push(e.target.result); 
                        resolve();
                    };
                    reader.onerror = reject;
                    reader.readAsDataURL(file);
                });
            });

            Promise.all(processFiles).then(() => {
                const newItem = {
                    id: Date.now(),
                    locatie: document.getElementById('probLocatie').value,
                    tip: document.getElementById('probTip').value,
                    desc: document.getElementById('probDesc').value,
                    data: new Date().toLocaleDateString(),
                    urgent: false, 
                    status: 'nou', 
                    comments: [],
                    poze: pozeArray // AdaugƒÉ Array-ul cu URL-urile imaginilor
                };
                
                data.probleme.unshift(newItem);
                saveData();
                
                const problemCard = e.target.closest('.card');
                problemCard.classList.add('submission-success');
                setTimeout(() => problemCard.classList.remove('submission-success'), 500);

                e.target.reset();
                showToast('‚úÖ ProblemƒÉ raportatƒÉ! Pozele au fost ata»ôate.');
            }).catch(error => {
                 showToast('‚ùå Eroare la citirea fi»ôierelor.');
                 console.error("File processing error:", error);
            });
        }

        function submitSuggestion(e) {
            e.preventDefault();
            const newItem = {
                id: Date.now(),
                nume: document.getElementById('sugestieNume').value || 'Anonim',
                email: document.getElementById('sugestieEmail').value || '-',
                text: document.getElementById('sugestieText').value,
                data: new Date().toLocaleDateString(),
                urgent: false, 
                status: 'nou',
                comments: []
            };
            data.sugestii.unshift(newItem);
            saveData();
            e.target.reset();
            
            const card = e.target.closest('.card');
            card.classList.add('submission-success');
            setTimeout(() => card.classList.remove('submission-success'), 500);

            showToast('‚úÖ Sugestie trimisƒÉ!');
        }

        function submitBullying(e) {
            e.preventDefault();
            const newItem = {
                id: Date.now(),
                desc: document.getElementById('bullDesc').value,
                detalii: document.getElementById('bullDetalii').value,
                data: new Date().toLocaleDateString(),
                urgent: false, 
                status: 'nou',
                comments: []
            };
            data.bullying.unshift(newItem);
            saveData();
            e.target.reset();
            
            const card = e.target.closest('.card');
            card.classList.add('submission-success');
            setTimeout(() => card.classList.remove('submission-success'), 500);

            showToast('‚úÖ Raport trimis anonim.');
        }

        function submitAcademic(e) {
            e.preventDefault();
            const selectedType = document.getElementById('acadTipSelect').value;
            
            if(!selectedType) return alert("SelecteazƒÉ un tip de problemƒÉ!");

            const newItem = {
                id: Date.now(),
                tip: selectedType, 
                desc: document.getElementById('acadDesc').value,
                data: new Date().toLocaleDateString(),
                urgent: false, 
                status: 'nou',
                comments: []
            };
            data.acad.unshift(newItem);
            saveData();
            e.target.reset();
            
            const card = e.target.closest('.card');
            card.classList.add('submission-success');
            setTimeout(() => card.classList.remove('submission-success'), 500);

            showToast('‚úÖ Solicitare trimisƒÉ!');
        }

        // --- 5. SONDAJ LOGIC ---
        
        function animatePollBars() {
            setTimeout(() => {
                document.querySelectorAll('#pollResultsDisplay .poll-bar-fill').forEach(fill => {
                    const percent = fill.getAttribute('data-poll-percent');
                    void fill.offsetWidth; 
                    fill.style.width = `${percent}%`;
                });
            }, 50); 
        }

        function renderPoll() {
            const voteKey = 'voted_poll_' + data.sondaj.intrebare.replace(/\s/g, '_'); 
            const hasVoted = localStorage.getItem(voteKey);
            
            document.getElementById('pollQuestionDisplay').innerText = data.sondaj.intrebare;
            
            const optionsDiv = document.getElementById('pollOptionsDisplay');
            const resultsDiv = document.getElementById('pollResultsDisplay');
            const voteBtn = document.getElementById('btnVote');

            optionsDiv.innerHTML = '';
            resultsDiv.innerHTML = '';

            if(hasVoted) {
                optionsDiv.style.display = 'none';
                voteBtn.style.display = 'none';
                resultsDiv.style.display = 'block';

                let total = data.sondaj.votes.reduce((a,b)=>a+b, 0);
                
                data.sondaj.optiuni.forEach((opt, i) => {
                    let val = data.sondaj.votes[i];
                    let pct = total ? Math.round((val/total)*100) : 0;
                    
                    resultsDiv.innerHTML += `
                        <div class="poll-result-item">
                            <div class="poll-result-text"><span>${opt}</span><span>${pct}% (${val})</span></div>
                            <div class="poll-bar-bg"><div class="poll-bar-fill" data-poll-percent="${pct}" style="width:0;"></div></div>
                        </div>
                    `;
                });
                
                animatePollBars();

            } else {
                optionsDiv.style.display = 'flex';
                voteBtn.style.display = 'block';
                resultsDiv.style.display = 'none';

                data.sondaj.optiuni.forEach((opt, i) => {
                    optionsDiv.innerHTML += `
                        <label class="poll-option-label">
                            <span style="display:flex; align-items:center;">
                                <input type="radio" name="pollVote" value="${i}"> ${opt}
                            </span>
                        </label>
                    `;
                });
            }
        }

        function submitVote() {
            const selected = document.querySelector('input[name="pollVote"]:checked');
            if(!selected) return alert("SelecteazƒÉ o op»õiune pentru a vota!");
            
            const idx = parseInt(selected.value); 
            
            if(isNaN(idx) || idx < 0 || idx >= data.sondaj.votes.length) {
                console.error("Invalid poll index:", selected.value);
                return alert("Eroare la √Ænregistrarea votului.");
            }

            data.sondaj.votes[idx]++;
            
            const voteKey = 'voted_poll_' + data.sondaj.intrebare.replace(/\s/g, '_'); 
            localStorage.setItem(voteKey, 'true');
            
            saveData();
            
            renderPoll(); 
            
            showToast('Vot √Ænregistrat!');
            
            const pollCard = document.getElementById('pollCard');
            pollCard.classList.add('submission-success');
            setTimeout(() => pollCard.classList.remove('submission-success'), 500);
        }

        // --- 6. ADMIN LOGIC ---
        function toggleAdminAuth() {
            if(isAdmin) {
                logoutAdmin();
            } else {
                let pass = prompt("Introdu parola de administrator:(1234)");
                if(pass === ADMIN_PASS) {
                    isAdmin = true;
                    document.getElementById('btnAdminAuth').innerText = "Deconectare"; // SchimbƒÉ √Æn "Deconectare"
                    document.getElementById('btnAdminAuth').style.background = "#c81919";
                    document.getElementById('admin-dashboard').classList.add('visible');
                    renderAdminPanel();
                    window.location.hash = 'admin'; // AdaugƒÉ √Æn URL hash
                    setTimeout(() => document.getElementById('admin-dashboard').scrollIntoView({behavior: 'smooth'}), 300);
                } else if (pass !== null) {
                    alert("ParolƒÉ incorectƒÉ!");
                }
            }
        }

        function logoutAdmin() {
            isAdmin = false;
            document.getElementById('btnAdminAuth').innerText = "Admin";
            document.getElementById('btnAdminAuth').style.background = "";
            document.getElementById('admin-dashboard').classList.remove('visible');
            window.location.hash = ''; // Scoate din URL hash
        }
        
        // V4.9 FIX: »òterge toate datele din localStorage »ôi reseteazƒÉ aplica»õia
        function adminDeleteAllData() {
            if(confirm("ATEN»öIE MAXIMƒÇ! AceastƒÉ ac»õiune va »ôterge absolut TOATE datele stocate (sesizƒÉri, sondaj, anun»õuri, calendar) din browserul tƒÉu »ôi te va deconecta. E»ôti sigur cƒÉ vrei sƒÉ continui?")) {
                localStorage.clear(); 
                data = createInitialData(); 
                isAdmin = false;
                showToast("Toate datele au fost »ôterse »ôi aplica»õia a fost resetatƒÉ.");
                window.location.reload(); 
            }
        }

        function adminPostContent() {
            const type = document.getElementById('adminPostType').value;
            const title = document.getElementById('adminPostTitle').value;
            const dateVal = document.getElementById('adminPostDate').value;
            const content = document.getElementById('adminPostContent').value;

            if(!title || !content) return alert("CompleteazƒÉ titlul »ôi con»õinutul");

            const newItem = { id: Date.now(), title, content, date: dateVal || new Date().toLocaleDateString() };

            if(type === 'anunt') {
                data.anunturi.unshift(newItem);
            } else {
                data.calendar.unshift(newItem);
            }
            saveData();
            document.getElementById('adminPostTitle').value = "";
            document.getElementById('adminPostContent').value = "";
            document.getElementById('adminPostDate').value = "";
            showToast("Con»õinut publicat!");
        }

        function adminUpdatePoll() {
            const newQuestion = document.getElementById('adminPollQuestion').value.trim();
            const newOptions = document.getElementById('adminPollOptions').value.trim().split('\n').filter(o => o.trim() !== '');

            if(!newQuestion || newOptions.length < 2) {
                return alert("Sondajul trebuie sƒÉ aibƒÉ o √Æntrebare »ôi cel pu»õin 2 op»õiuni.");
            }

            const voteKey = 'voted_poll_' + data.sondaj.intrebare.replace(/\s/g, '_'); 
            localStorage.removeItem(voteKey); 

            data.sondaj = {
                intrebare: newQuestion,
                optiuni: newOptions,
                votes: new Array(newOptions.length).fill(0)
            };
            
            saveData();
            showToast("Sondaj actualizat »ôi voturi resetate!");
        }
        
        function adminResetPollVotes() {
             if(confirm("E»ôti sigur cƒÉ vrei sƒÉ resetezi doar voturile (pƒÉstr√¢nd √Æntrebarea »ôi op»õiunile)?")) {
                data.sondaj.votes = new Array(data.sondaj.optiuni.length).fill(0);
                
                const voteKey = 'voted_poll_' + data.sondaj.intrebare.replace(/\s/g, '_'); 
                localStorage.removeItem(voteKey); 
                
                saveData();
                showToast("Voturile sondajului au fost resetate!");
            }
        }


        function deleteItem(type, id) {
            if(confirm(`»òtergi elementul din ${type.toUpperCase()}?`)) {
                data[type] = data[type].filter(i => i.id !== id);
                saveData();
                showToast("Element »ôters!");
            }
        }
        
        function toggleStatus(type, id) {
            const item = data[type].find(i => i.id === id);
            if(item && type !== 'sugestii') {
                item.status = (item.status === 'nou') ? 'rezolvat' : 'nou';
                saveData();
            }
        }

        function toggleUrgent(type, id) {
            const item = data[type].find(i => i.id === id);
            if(item && (type === 'probleme' || type === 'acad')) {
                item.urgent = !item.urgent;
                saveData();
            }
        }

        function addComment(type, id) {
            const item = data[type].find(i => i.id === id);
            const input = document.getElementById(`commentInput_${type}_${id}`);
            const text = input.value.trim();

            if(!text || !item) return;

            item.comments.push({
                text: text,
                data: new Date().toLocaleDateString()
            });
            saveData();
            input.value = ''; 
        }

        // --- 7. RENDER GENERAL ---
        function renderPublicContent() {
            // Calendar
            const calDiv = document.getElementById('calendarDisplay');
            if(data.calendar.length === 0) calDiv.innerHTML = '<p style="color:#666">Nu sunt evenimente.</p>';
            else {
                calDiv.innerHTML = data.calendar.map(c => `
                    <div class="data-item" style="border-left: 4px solid var(--acad-color);">
                        <div class="item-meta"><span>üìÖ ${c.date}</span></div>
                        <div style="font-weight:700; font-size:1.1rem">${c.title}</div>
                        <div style="margin-top:5px">${c.content}</div>
                    </div>
                `).join('');
            }

            // Anun»õuri
            const anuntDiv = document.getElementById('announcementsDisplay');
            if(data.anunturi.length === 0) anuntDiv.innerHTML = '<p style="color:#666">Nu sunt anun»õuri.</p>';
            else {
                anuntDiv.innerHTML = data.anunturi.map(a => `
                    <div class="data-item" style="border-left: 4px solid var(--resurse-color);">
                        <div class="item-meta"><span>üì¢ ${a.date}</span></div>
                        <div style="font-weight:700; font-size:1.1rem">${a.title}</div>
                        <div style="margin-top:5px">${a.content}</div>
                    </div>
                `).join('');
            }

            renderPoll();
        }
        
        function renderImages(images) {
             if (images.length === 0) return '';
             const imageTags = images.map(src => `<img src="${src}" alt="PozƒÉ ProblemƒÉ" onclick="window.open(this.src)">`).join('');
             return `<div class="item-images">Imagini: ${imageTags}</div>`;
        }


        function renderCommentsSection(item, type) {
            const commentList = item.comments.map(c => `
                <div class="comment-item">
                    <div class="comment-meta">Admin (${c.data})</div>
                    ${c.text}
                </div>
            `).join('');

            return `
                <div class="comments-section">
                    <h5 style="margin-top:0; color:var(--primary);">Comentarii (${item.comments.length})</h5>
                    ${commentList}
                    <div class="comment-form">
                        <textarea id="commentInput_${type}_${item.id}" placeholder="AdaugƒÉ notƒÉ/comentariu..."></textarea>
                        <button class="btn-small" style="background:var(--accent)" onclick="addComment('${type}', ${item.id})">AdaugƒÉ</button>
                    </div>
                </div>
            `;
        }

        function renderAdminPanel() {
            // PopuleazƒÉ Editorul de Sondaj
            document.getElementById('adminPollQuestion').value = data.sondaj.intrebare;
            document.getElementById('adminPollOptions').value = data.sondaj.optiuni.join('\n');

            // PROGRESS BAR PROBLEME 
            const totalProbleme = data.probleme.length + data.acad.length + data.bullying.length;
            const rezolvate = data.probleme.filter(p => p.status === 'rezolvat').length + 
                             data.acad.filter(a => a.status === 'rezolvat').length +
                             data.bullying.filter(b => b.status === 'rezolvat').length;
            
            const percentage = totalProbleme > 0 ? Math.round((rezolvate / totalProbleme) * 100) : 0; 
            const bar = document.getElementById('problemeProgressBar');
            bar.style.width = percentage + '%';
            bar.innerText = percentage + '%';
            bar.classList.toggle('resolved', percentage > 0);
            document.getElementById('countsSpan').textContent = `Total: ${totalProbleme} | Rezolvate: ${rezolvate}`;


            // Render Liste Publice pentru Gestiune (V4.9 FIX)
            document.getElementById('adminListCalendar').innerHTML = data.calendar.map(c => `
                <div class="data-item" style="border-left: 4px solid var(--acad-color); margin-bottom: 10px;">
                    <div class="item-meta"><span>üìÖ ${c.date}</span></div>
                    <div style="font-weight:700; font-size:1.0rem">${c.title}</div>
                    <div class="admin-controls" style="padding-top: 5px; margin-top: 5px; border-top: 1px dashed #ccc;">
                        <button class="btn-small btn-del" onclick="deleteItem('calendar', ${c.id})">»òterge Eveniment</button>
                    </div>
                </div>
            `).join('') || '<p style="color:var(--muted)">Nu sunt evenimente.</p>';

            document.getElementById('adminListAnunturi').innerHTML = data.anunturi.map(a => `
                <div class="data-item" style="border-left: 4px solid var(--resurse-color); margin-bottom: 10px;">
                    <div class="item-meta"><span>üì¢ ${a.date}</span></div>
                    <div style="font-weight:700; font-size:1.0rem">${a.title}</div>
                    <div class="admin-controls" style="padding-top: 5px; margin-top: 5px; border-top: 1px dashed #ccc;">
                        <button class="btn-small btn-del" onclick="deleteItem('anunturi', ${a.id})">»òterge Anun»õ</button>
                    </div>
                </div>
            `).join('') || '<p style="color:var(--muted)">Nu sunt anun»õuri.</p>';


            // Render Probleme (INCLUSIV POZE)
            document.getElementById('adminListProbleme').innerHTML = data.probleme.map(p => `
                <div class="data-item ${p.urgent ? 'urgent-item' : ''}">
                    <div class="item-meta">
                        <span>${p.data} | ${p.locatie}</span> 
                        <span style="font-weight:bold; color:${p.status === 'rezolvat' ? '#10b981' : '#9ca3af'}">${p.tip} (${p.status.toUpperCase()})</span>
                    </div>
                    <div class="item-content">${p.desc}</div>
                    ${renderImages(p.poze || [])} <div class="admin-controls">
                        <button class="btn-small ${p.status === 'nou' ? 'btn-resolve' : 'btn-status-nou'}" onclick="toggleStatus('probleme', ${p.id})">
                            ${p.status === 'nou' ? 'MarcheazƒÉ Rezolvat' : 'MarcheazƒÉ Nou'}
                        </button>
                        <button class="btn-small btn-mark-urgent" onclick="toggleUrgent('probleme', ${p.id})">
                            ${p.urgent ? 'Scoate Urgent' : 'MarcheazƒÉ Urgent'}
                        </button>
                        <button class="btn-small btn-del" onclick="deleteItem('probleme', ${p.id})">»òterge</button>
                    </div>
                    ${renderCommentsSection(p, 'probleme')}
                </div>
            `).join('');

            // Render Sugestii (FƒÇRƒÇ buton de Rezolvare)
            document.getElementById('adminListSugestii').innerHTML = data.sugestii.map(s => `
                <div class="data-item" style="border-left-color: var(--sugestii-color);">
                    <div class="item-meta"><span>${s.data}</span> <span>${s.nume} (${s.email})</span></div>
                    <div class="item-content">${s.text}</div>
                    <div class="admin-controls">
                        <button class="btn-small btn-del" onclick="deleteItem('sugestii', ${s.id})">»òterge</button>
                    </div>
                    ${renderCommentsSection(s, 'sugestii')}
                </div>
            `).join('');

            // Render Bullying
            document.getElementById('adminListBullying').innerHTML = data.bullying.map(b => `
                <div class="data-item" style="border-left-color: var(--bullying-color);">
                    <div class="item-meta"><span>${b.data}</span> <span style="color:red">Confiden»õial</span></div>
                    <div class="item-content">${b.desc} <br><small>Detalii: ${b.detalii}</small></div>
                    <div class="admin-controls">
                         <button class="btn-small ${b.status === 'nou' ? 'btn-resolve' : 'btn-status-nou'}" onclick="toggleStatus('bullying', ${b.id})">
                            ${b.status === 'nou' ? 'MarcheazƒÉ Rezolvat' : 'MarcheazƒÉ Nou'}
                        </button>
                        <button class="btn-small btn-del" onclick="deleteItem('bullying', ${b.id})">»òterge</button>
                    </div>
                    ${renderCommentsSection(b, 'bullying')}
                </div>
            `).join('');

            // Render Academice
            document.getElementById('adminListAcad').innerHTML = data.acad.map(a => {
                const tipDisplay = a.tip || 'Nespecificat';

                return `
                    <div class="data-item ${a.urgent ? 'urgent-item' : ''}" style="border-left-color: var(--acad-color);">
                        <div class="item-meta">
                            <span>${a.data}</span> 
                            <span style="font-weight:bold; color:${a.status === 'rezolvat' ? '#10b981' : '#9ca3af'}">
                                ${tipDisplay} (${a.status.toUpperCase()})
                            </span>
                        </div>
                        <div class="item-content">${a.desc}</div>
                        <div class="admin-controls">
                            <button class="btn-small ${a.status === 'nou' ? 'btn-resolve' : 'btn-status-nou'}" onclick="toggleStatus('acad', ${a.id})">
                                ${a.status === 'nou' ? 'MarcheazƒÉ Rezolvat' : 'MarcheazƒÉ Nou'}
                            </button>
                            <button class="btn-small btn-mark-urgent" onclick="toggleUrgent('acad', ${a.id})">
                                ${a.urgent ? 'Scoate Urgent' : 'MarcheazƒÉ Urgent'}
                            </button>
                            <button class="btn-small btn-del" onclick="deleteItem('acad', ${a.id})">»òterge</button>
                        </div>
                        ${renderCommentsSection(a, 'acad')}
                    </div>
                `;
            }).join('');
        }
        
        // Face»õi func»õiile necesare disponibile global pentru HTML
        window.toggleStatus = toggleStatus;
        window.toggleUrgent = toggleUrgent;
        window.deleteItem = deleteItem; 
        window.addComment = addComment; 
        window.adminUpdatePoll = adminUpdatePoll;
        window.adminResetPollVotes = adminResetPollVotes;
        window.adminDeleteAllData = adminDeleteAllData; 
        window.submitProblem = submitProblem; // AsigurƒÉ cƒÉ func»õia actualizatƒÉ e disponibilƒÉ
        window.burstStarAnimation = burstStarAnimation; // Anima»õia stelu»õei
        
        // Re-mapeazƒÉ data la √ÆncƒÉrcare pentru a afi»ôa evenimentele/anun»õurile default
        document.addEventListener('DOMContentLoaded', () => {
            // ... (restul logicii) ...
            renderPublicContent();
        });
        
    </script>
</body>
</html>

